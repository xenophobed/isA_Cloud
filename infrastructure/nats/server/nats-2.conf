# NATS Server Configuration for isA_Cloud - Node 2
# Second node in the 3-node cluster

# Server identification
server_name: "isa-cloud-nats-2"
listen: 0.0.0.0:4222

# HTTP monitoring
http_port: 8222

# Cluster configuration
cluster {
  name: "isa-cloud-cluster"
  listen: 0.0.0.0:6222
  
  # Routes to other nodes
  routes: [
    nats-route://nats-1:6222
    nats-route://nats-3:6222
  ]
}

# JetStream configuration
jetstream {
  store_dir: "/data/jetstream"
  max_memory_store: 1073741824
  max_file_store: 10737418240
}

# Logging
debug: false
trace: false
logtime: true
log_file: "/var/log/nats/nats.log"

# Authorization (same as node 1)
authorization {
  default_permissions {
    publish: ">"
    subscribe: ">"
  }
  
  users: [
    {
      user: "isa_cloud_admin"
      password: "admin123"
      permissions {
        publish: ">"
        subscribe: ">"
      }
    },
    {
      user: "isa_user_service"
      password: "service123"
      permissions {
        publish: ["events.>", "commands.>", "$js.>", "$js.api.>"]
        subscribe: ["events.>", "commands.>", "_INBOX.>", "$js.>"]
      }
    }
  ]
}

# system_account: "SYS"
max_connections: 10000
max_control_line: 4096
max_payload: 1048576
max_pending: 67108864
ping_interval: "2m"
ping_max: 2